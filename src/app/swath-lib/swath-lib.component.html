<div class="container-fluid">
  <!--<ngb-tabset type="pills">
    <ngb-tab title="Input">
      <ng-template ngbTabContent>
        <div class="card mt-2">
          <div class="card-body">
            <div class="form-group">
              <label for="FastaRaw">Fasta Content:</label>
              <div>
                <textarea class="form-control" id="FastaRaw" name="FastaRaw" [(ngModel)]="fastaRaw" required rows="2">
              </textarea>
              </div>

            </div>
            <h4 class="text-muted">
              OR.
            </h4>
            <div class="form-group">
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text" id="label-fasta-input">Fasta Input:</span>
                </div>
                <div class="custom-file">
                  <input type="file" class="custom-file-input" aria-label="fasta-input" aria-describedby="label-fasta-input" (change)="handleFile($event)" required>
                  <label class="custom-file-label" for="label-fasta-input">{{fileName||'Select File'}}</label>
                </div>

              </div>
              <div *ngIf="fasta|async; let fasta">
                <small id="peptide-summary-rows" class="form-text text-muted">
                  {{fasta.content.length}} peptides have been loaded.
                </small>
              </div>
            </div>
            <div class="row">
              <div class="col-9"></div>
              <div class="col-3 text-right">
                <button class="btn btn-primary" (click)="processFastaContent()">
                  Process Input
                </button>
              </div>
            </div>
          </div>
        </div>
        <app-queryset-parameter-form (queryForm)="applyModification($event)" [rt]="rt"></app-queryset-parameter-form>
      </ng-template>
    </ngb-tab>
    <ngb-tab title="Settings">
      <ng-template ngbTabContent>
        <app-user-settings (rt)="UpdateRT($event)"></app-user-settings>
      </ng-template>
    </ngb-tab>
    <ngb-tab title="Help">
      <ng-template ngbTabContent>
        <app-swath-lib-help></app-swath-lib-help>
      </ng-template>
    </ngb-tab>
  </ngb-tabset>-->
  <div class="card mt-2">
    <div class="card-body">
      <div class="form-group">
        <label for="FastaRaw">Fasta Content:</label>
        <div>
                <textarea class="form-control" id="FastaRaw" name="FastaRaw" [(ngModel)]="fastaRaw" required rows="2">
              </textarea>
        </div>

      </div>
      <h4 class="text-muted">
        OR.
      </h4>
      <div class="form-group">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text" id="label-fasta-input">Fasta Input:</span>
          </div>
          <div class="custom-file">
            <input type="file" class="custom-file-input" aria-label="fasta-input" aria-describedby="label-fasta-input" (change)="handleFile($event)" required>
            <label class="custom-file-label" for="label-fasta-input">{{fileName||'Select File'}}</label>
          </div>

        </div>
        <div *ngIf="fasta|async; let fasta">
          <small id="peptide-summary-rows" class="form-text text-muted">
            {{fasta.content.length}} peptides have been loaded.
          </small>
        </div>
      </div>
      <div class="row">
        <div class="col-9"></div>
        <div class="col-3 text-right">
          <button class="btn btn-primary" (click)="processFastaContent()">
            Process Input
          </button>
        </div>
      </div>
    </div>
  </div>
  <app-queryset-parameter-form (queryForm)="applyModification($event)" [rt]="rt"></app-queryset-parameter-form>
</div>

<!--<div class="container-fluid mb-4" *ngIf="fasta|async; let fasta">
  <hr/>
  <app-sequence-selector *ngFor="let p of fasta.content" [protein]="p" [form]="passForm"></app-sequence-selector>

  <div class="text-right mt-4">
    <button type="button" class="btn btn-primary" [disabled]="collectTrigger" (click)="SendQueries()">Submit Queries</button>
  </div>


  <div class="text-right mt-4" *ngIf="finished">
    <div class="row">
      <div class="col-sm-8">
        Query finished on {{finishedTime|date:'full'}}
      </div>
      <div class="col-sm-4 text-right">
        <button type="button" class="btn btn-success" (click)="downloadFile()">Save Compiled Results</button>
      </div>
    </div>

  </div>


</div>-->

<ng-template #loading>
  <h6 class="card-subtitle mb-2 text-muted">Loading <i class="fa fa-circle-o-notch fa-spin"></i></h6>
</ng-template>

<ng-template #emptySelection>
  <div class="form-group col-md-4">
    <label for="staticModsEmpty">Selected Static mods:</label>
    <select multiple class="form-control" id="staticModsEmpty">
      <option>None</option>
    </select>
  </div>
</ng-template>

<ng-template #trypticDigest let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title">Protein Input</h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">

    <div class="container-fluid">
      <ul class="list-group input-list">
        <li class="list-group-item list-group-item-secondary">
          <div class="row">
            <div class="col-1">
              <input type="checkbox" (click)="changeAllBox()" [(ngModel)]="currentAllBoxes">
            </div>
            <div class="col-2">
              <p>
                Sequence Name
              </p>
            </div>
            <div class="col-6">
              <p>
                Sequence
              </p>
            </div>
            <div class="col-3">
              Tryptic Digestion
            </div>
          </div>
        </li>
        <li class="list-group-item list-group-item{{colorMap.get(digestMap[f.unique_id].accept)}} list-group-item-action sequence" *ngFor="let f of fastaContent.content">
          <div class="row">
            <div class="col-1">
              <input type="checkbox" [(ngModel)]="digestMap[f.unique_id].accept" (change)="changeAccept(f.unique_id)">
            </div>
            <div class="col-2">
              <p>
                {{f.id}}
              </p>
            </div>
            <div class="col-6">
              <p>
                {{f.sequence}}
              </p>
            </div>
            <div class="col-3">
              <div *ngIf="digestRules|async; let digestRules">
                <div>
                  <div class="input-group-sm">
                    <input type="text" class="form-control" placeholder="Fixed-miscleaved sites" [(ngModel)]="digestMap[f.unique_id].misCleave">
                  </div>
                </div>

                <div class="input-group mt-2">
                  <div class="input-group-prepend">
                    <span class="input-group-text">Auto miscleavages</span>
                  </div>
                  <div class="input-group-append">
                    <div class="input-group-text">
                      <input [(ngModel)]="digestMap[f.unique_id].autoCleave" type="checkbox">
                    </div>
                  </div>
                </div>

                <div class="input-group mt-2">
                  <select class="custom-select" id="digestRules" [(ngModel)]="digestMap[f.unique_id].rules">
                    <option *ngFor="let d of digestRules" [ngValue]="d">
                      {{d.name}}
                    </option>
                  </select>
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-danger" (click)="digest(f)">Digest</button>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
  <div class="modal-footer">
    <div class="input-group">
      <select class="custom-select" id="filterRegex" [(ngModel)]="filterChoice">
        <option *ngFor="let f of regexFilter" [ngValue]="f">{{f.name}}</option>
      </select>
      <span class="input-group-btn">
        <button type="button" class="btn btn-danger" (click)="filterSeq()">Filter Selected</button>
      </span>
    </div>
    <button type="button" class="btn btn-warning ml-auto" (click)="fetchUniprot()">Fetch Uniprot Sequence</button>
    <button type="button" class="btn btn-secondary" (click)="exportFasta()">Export Fasta File</button>
    <button type="button" class="btn btn-primary" (click)="acceptContent()">Accept <span class="badge badge-light">{{acceptTrack}}</span></button>
  </div>
</ng-template>
